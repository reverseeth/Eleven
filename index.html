<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>E-Commerce Results & Profit Margin Calculator</title>
  <style>
    :root{
      --bg:#0b0c10;--card:#15171e;--muted:#8b90a2;--text:#e9ecf4;--accent:#0052ff;--accent-2:#5aa0ff;
      --radius:20px;--shadow:0 8px 28px rgba(0,0,0,.35);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font:16px/1.5 "Helvetica Neue", Helvetica, Arial, sans-serif;color:var(--text);background:var(--bg)}
    .wrap{max-width:1440px;margin:40px auto;padding:0 28px 72px}

    header{display:flex;align-items:center;justify-content:center;position:relative;margin-bottom:24px;flex-wrap:wrap;}
    header .left-logo{position:absolute;left:0;top:50%;transform:translateY(-50%);display:flex;align-items:center;gap:10px}
    header .center-title{text-align:center;z-index:2;}
    h1{font-size:clamp(26px,3vw,40px);margin:0 0 6px;letter-spacing:.2px}
    .sub{color:var(--muted);font-size:14px}

    .badge{display:inline-flex;align-items:center;justify-content:center;padding:10px 16px;background:linear-gradient(180deg,var(--accent),#0042cc);color:#fff;border-radius:14px;font-weight:700;box-shadow:0 10px 24px rgba(0,82,255,.35);position:absolute;right:0;top:50%;transform:translateY(-50%)}

    .cards{display:grid;grid-template-columns:1fr;gap:26px}
    .card{background:var(--card);padding:22px;border-radius:var(--radius);box-shadow:var(--shadow);border:1px solid rgba(255,255,255,.06)}
    .card h2{margin:4px 0 16px;font-size:20px}
    .field{display:grid;grid-template-columns:1fr auto;gap:10px;align-items:center;margin:12px 0}
    input[type="number"], input[type="text"]{width:320px;max-width:100%;background:#0f1117;border:1px solid rgba(255,255,255,.08);color:var(--text);padding:10px 12px;border-radius:12px;outline:none}
    input[type="number"]:focus, input[type="text"]:focus{border-color:var(--accent)}
    .row{display:flex;gap:12px;flex-wrap:wrap}

    .chips{display:grid;grid-template-columns:repeat(4, max-content);gap:8px;align-items:center}
    .chip{display:inline-flex;align-items:center;gap:6px;padding:8px 14px;border-radius:999px;background:rgba(255,255,255,.06);font-size:13px;color:#d6dbeb;min-width:fit-content}
    .chip strong{color:#fff}
    .chip span{color:#cfd5e9}
    .chip.accent{background:linear-gradient(180deg,var(--accent),#0042cc);color:#fff;box-shadow:none}

    .out{display:flex;flex-direction:column;gap:10px;margin-top:8px}
    .out .line{display:flex;justify-content:space-between;border-bottom:1px dashed rgba(255,255,255,.08);padding:8px 0}
    .out .k{color:#c9cee3;position:relative;display:inline-flex;align-items:center;gap:6px}
    .out .info-btn{width:18px;height:18px;display:inline-flex;align-items:center;justify-content:center;border:1px solid rgba(255,255,255,.25);border-radius:50%;background:transparent;color:#cfd5e9;font-size:11px;line-height:1;cursor:pointer;box-shadow:none}
    .out .info-btn:focus{outline:none;border-color:var(--accent)}
    .out .v{font-variant-numeric:tabular-nums}

    #tip{position:absolute;display:none;background:#0f131d;color:#fff;border:1px solid rgba(255,255,255,.12);padding:10px 12px;border-radius:12px;box-shadow:0 10px 28px rgba(0,0,0,.35);max-width:320px;z-index:50}

    .actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:14px}
    button{border:0;background:var(--accent);color:#fff;padding:10px 14px;border-radius:12px;font-weight:600;cursor:pointer;box-shadow:0 8px 18px rgba(0,82,255,.35)}
    button.ghost{background:transparent;border:1px solid rgba(255,255,255,.15);color:#d6dbeb}

    @media (max-width: 640px){
      .wrap{padding:0 16px 84px}
      h1{font-size:28px}
      .card{padding:18px}
      input[type="number"], input[type="text"]{width:100%}
      .field{grid-template-columns:1fr;gap:6px}
      header{flex-direction:column;gap:10px;position:static}
      header .left-logo{position:static;transform:none;margin-bottom:10px}
      .badge{position:static;transform:none}
      .chips{grid-template-columns:repeat(2, minmax(0, max-content))}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="left-logo">
        <svg viewBox="0 0 909.52 909.52" width="36" height="36" style="fill:#fff;display:block">
          <polygon points="0 0 0 184.85 178.98 363.82 178.98 181.91 909.52 181.91 909.52 0 0 0"/>
          <polygon points="178.97 366.77 357.99 545.71 178.97 545.71 178.97 727.62 .03 548.67 .03 363.81 178.97 363.81 178.97 366.77"/>
          <rect x="357.99" y="363.81" width="551.5" height="181.9"/>
          <polygon points="178.97 730.58 357.99 909.52 .03 909.52 .03 727.62 178.97 727.62 178.97 730.58"/>
          <rect x="357.99" y="727.62" width="551.5" height="181.9"/>
        </svg>
      </div>
      <div class="center-title">
        <h1>E-Commerce Results Calculator</h1>
        <div class="sub">Preencha primeiro a margem (calculadora abaixo). Os resultados são atualizados em tempo real.</div>
      </div>
      <div class="badge" id="roiBadge">ROI: 0%</div>
    </header>

    <section class="cards">
      <article class="card" id="pmCard">
        <h2>Profit Margin Calculator</h2>
        <div class="field"><label>Price of Product + Shipping</label><input id="price" type="number" step="0.01" min="0" value="89.99"></div>
        <div class="field"><label>Cost of Product + Shipping</label><input id="cost" type="number" step="0.01" min="0" value="28.00"></div>
        <div class="row">
          <div class="chip">Your Profit Margin: <strong id="pmOut">0.688</strong></div>
          <div class="chip">Markup: <strong id="markup">221% or 2.21x</strong></div>
        </div>
      </article>

      <article class="card" id="roiCard">
        <h2>Ad Performance & ROI</h2>
        <div class="row">
          <div class="field"><label>Average (Gross) Profit Margin</label><input id="apm" type="number" step="0.001" min="0" max="1" value="0.600"></div>
          <div class="field" style="grid-column:1 / -1">
            <label>Breakeven & CPA targets</label>
            <div class="chips">
              <div class="chip accent"><span>Breakeven ROAS:</span> <strong id="breakeven">1.67</strong></div>
              <div class="chip accent"><span>BE CPA:</span> <strong id="beCPA">$0</strong></div>
              <div class="chip"><span>Target CPA 2x:</span> <strong id="targetCPA2x">$0</strong></div>
              <div class="chip"><span>Target CPA 2.5x:</span> <strong id="targetCPA2_5x">$0</strong></div>
            </div>
          </div>
        </div>
        <div class="field"><label>Monthly Ad Spend</label><input id="adSpend" type="number" step="500" min="0" value="20000"></div>
        <div class="field"><label>Expected ROAS</label><input id="roas" type="number" step="0.1" min="0" value="6.00"></div>
        <div class="field"><label>Monthly Team & Staff Costs</label><input id="teamFee" type="number" step="50" min="0" value="2000"></div>
        <div class="out">
          <div class="line"><div class="k" data-tip="Faturamento gerado pelos anúncios: Ad Spend × ROAS.">Revenue From Ad Spend (ROAS)<button class="info-btn">i</button></div><div class="v" id="revenue">$0/month</div></div>
          <div class="line"><div class="k" data-tip="Lucro bruto sobre a receita (aplica sua margem média).">Profit After Margin<button class="info-btn">i</button></div><div class="v" id="pam">$0/month</div></div>
          <div class="line"><div class="k" data-tip="Lucro bruto menos o investimento em anúncios.">Profit After Ad Spend<button class="info-btn">i</button></div><div class="v" id="paAd">$0/month</div></div>
          <div class="line"><div class="k" data-tip="Lucro após anúncios e custos fixos de time/equipe.">Net Profit<button class="info-btn">i</button></div><div class="v" id="trueProfit">$0/month</div></div>
          <div class="line"><div class="k" data-tip="Percentual que sobra do faturamento após anúncios e custos: Net Profit ÷ Revenue.">Profit Margin After Ads<button class="info-btn">i</button></div><div class="v" id="profitMarginAfterAds">0%</div></div>
        </div>
        <div class="actions"><button class="ghost" id="shareBtn">Copiar link com estes valores</button></div>
      </article>
    </section>
  </div>

  <div id="tip"></div>

  <script>
  (function(){
    const $ = sel => document.querySelector(sel);
    const money0 = v => {if(v>=1000) return `$${(v/1000).toFixed(1)}k`;return v.toLocaleString('en-US', { style:'currency', currency:'USD', maximumFractionDigits:0 });};
    const clamp=(v,min,max)=>Math.min(max,Math.max(min,v));const toNum=el=>parseFloat(el?.value||0)||0;
    const apm=$('#apm'),adSpend=$('#adSpend'),roas=$('#roas'),teamFee=$('#teamFee'),
    breakeven=$('#breakeven'),revenue=$('#revenue'),pam=$('#pam'),paAd=$('#paAd'),trueProfit=$('#trueProfit'),roiBadge=$('#roiBadge'),
    price=$('#price'),cost=$('#cost'),pmOut=$('#pmOut'),markup=$('#markup'),beCPA=$('#beCPA'),targetCPA2x=$('#targetCPA2x'),targetCPA2_5x=$('#targetCPA2_5x'),profitMarginAfterAds=$('#profitMarginAfterAds'),shareBtn=$('#shareBtn');

    function calcPM(){const p=toNum(price),c=toNum(cost);const margin=p>0?clamp((p-c)/p,0,1):0;pmOut.textContent=(Math.round(margin*1000)/1000).toFixed(3);const mk=p>0?(p-c)/c:0;const mkPct=Math.round(mk*100);const mkXStr=(Math.round(mk*100)/100).toFixed(mk<10?2:1);markup.textContent=`${mkPct}% or ${mkXStr}x`;const beCPAVal=Math.max(0,p-c);const target2x=beCPAVal/2;const target2_5x=beCPAVal/2.5;beCPA.textContent=money0(beCPAVal);targetCPA2x.textContent=money0(target2x);targetCPA2_5x.textContent=money0(target2_5x);return margin;}

    function calcBottom(){const margin=toNum(apm),spend=toNum(adSpend),r=toNum(roas),team=toNum(teamFee);const breq=margin>0?(1/margin):0;const rev=spend*r;const pAfterMargin=rev*margin;const pAfterAd=pAfterMargin-spend;const trueP=pAfterAd-team;breakeven.textContent=breq.toFixed(2);revenue.textContent=money0(rev)+'/month';pam.textContent=money0(pAfterMargin)+'/month';paAd.textContent=money0(pAfterAd)+'/month';trueProfit.textContent=money0(trueP)+'/month';const roiPct=spend>0?(trueP/spend)*100:0;const profitMarginAdPct=rev>0?(trueP/rev)*100:0;roiBadge.textContent=`ROI: ${Math.round(roiPct)}%`;profitMarginAfterAds.textContent=`${profitMarginAdPct.toFixed(1)}%`;return{trueP,roiPct};}

    function syncMargin(){const m=calcPM();apm.value=(Math.round(m*1000)/1000).toFixed(3);calcBottom();saveToQuery();}

    [price,cost].forEach(el=>{['input','change'].forEach(ev=>el.addEventListener(ev,syncMargin));});[apm,adSpend,roas,teamFee].forEach(el=>{['input','change'].forEach(ev=>el.addEventListener(ev,()=>{calcBottom();saveToQuery();}));});

    function saveToQuery(){const params=new URLSearchParams({price:price.value,cost:cost.value,apm:apm.value,spend:adSpend.value,roas:roas.value,team:teamFee.value});const url=`${location.pathname}?${params.toString()}`;history.replaceState(null,'',url);}

    function loadFromQuery(){const q=new URLSearchParams(location.search);const set=(el,key)=>{if(q.has(key))el.value=q.get(key);};set(price,'price');set(cost,'cost');set(apm,'apm');set(adSpend,'spend');set(roas,'roas');set(teamFee,'team');}

    shareBtn.addEventListener('click',async()=>{saveToQuery();const shareUrl=location.href;try{await navigator.clipboard.writeText(shareUrl);shareBtn.textContent='Link copiado!';setTimeout(()=>shareBtn.textContent='Copiar link com estes valores',1500);}catch(e){alert(shareUrl);}});

    loadFromQuery();syncMargin();

    const tipEl=document.getElementById('tip');
    function showTip(target){const msg=target.getAttribute('data-tip');if(!msg)return;tipEl.textContent=msg;const r=target.getBoundingClientRect();const top=window.scrollY+r.bottom+8;const left=window.scrollX+r.left;tipEl.style.top=top+'px';tipEl.style.left=left+'px';tipEl.style.display='block';}
    function hideTip(){tipEl.style.display='none';}
    document.querySelectorAll('.out .k').forEach(k=>{const btn=k.querySelector('.info-btn');const handler=(e)=>{e.stopPropagation();if(tipEl.style.display==='block'){hideTip();}else{showTip(k);}};k.addEventListener('click',handler);if(btn)btn.addEventListener('click',handler);});
    document.addEventListener('click',hideTip);window.addEventListener('scroll',hideTip,{passive:true});
  })();
